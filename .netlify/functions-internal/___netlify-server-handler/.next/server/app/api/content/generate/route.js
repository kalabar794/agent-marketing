"use strict";(()=>{var a={};a.id=957,a.ids=[957],a.modules={261:a=>{a.exports=require("next/dist/shared/lib/router/utils/app-paths")},3295:a=>{a.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},10846:a=>{a.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},29021:a=>{a.exports=require("fs")},29231:(a,b,c)=>{c.a(a,async(a,d)=>{try{c.d(b,{X:()=>k});var e=c(30007),f=c(74674),g=c(35221),h=c(70955),i=c(54808),j=a([e,f]);[e,f]=j.then?(await j)():j;class k{static{this.instances=new Map}static setInstance(a,b){this.instances.set(a,b)}static async loadPersistedStatus(a){try{let b=await Promise.resolve().then(c.t.bind(c,29021,23)).then(a=>a.promises),d=(await Promise.resolve().then(c.t.bind(c,33873,23))).join("/tmp",`workflow-${a}.json`),e=await b.readFile(d,"utf-8"),f=JSON.parse(e);return f.startTime&&(f.startTime=new Date(f.startTime)),f.endTime&&(f.endTime=new Date(f.endTime)),f}catch(a){return null}}constructor(a,b={}){this.id=this.generateId(),this.request=a,this.options={priorityMode:"balanced",enableOptimization:!0,maxOptimizationCycles:2,enableFallbacks:!0,...b},this.orchestrator=new e.r,this.evaluator=new f.l,this.delegator=new g.c,this.errorRecovery=new h.N,this.storage=new i.P,this.executionStartTime=new Date;let c=this.delegator.delegateTasks(a,this.options.maxExecutionTime,this.options.priorityMode);this.status={id:this.id,status:"pending",progress:0,agents:this.initializeAgentStatus(c.selectedTasks),startTime:this.executionStartTime,estimatedTimeRemaining:Math.ceil(c.estimatedDuration/60),currentAgent:c.selectedTasks[0]?.agentId},k.instances.set(this.id,this),console.log(`🚀 Enhanced workflow ${this.id} initialized:`,{contentType:a.contentType,selectedTasks:c.selectedTasks.length,estimatedDuration:`${Math.ceil(c.estimatedDuration/60)}m`,priorityMode:this.options.priorityMode})}static getInstance(a){return k.instances.get(a)}generateId(){return`enhanced-workflow-${Date.now()}-${Math.random().toString(36).substr(2,9)}`}initializeAgentStatus(a){return a.map(a=>({agentId:a.agentId,status:"pending",progress:0}))}async start(){return this.status.status="running",this.executeEnhancedWorkflow().catch(a=>{console.error("Enhanced workflow execution failed:",a),this.status.status="failed",this.status.error=a instanceof Error?a.message:"Unknown error"}),this.id}setProgressCallback(a){this.progressCallback=a}async executeEnhancedWorkflow(){try{console.log(`🚀 Starting enhanced workflow execution for ${this.request.contentType}`),console.log("\uD83D\uDCCB Phase 1: Dynamic Task Planning"),this.delegator.delegateTasks(this.request,this.options.maxExecutionTime,this.options.priorityMode),console.log("\uD83D\uDD04 Phase 2: Enhanced Agent Execution");let a=await this.orchestrator.executeWorkflow(this.request,(a,b)=>{this.updateAgentProgress(a,b),this.progressCallback&&this.progressCallback(a,b)});await this.storeIntermediateResults(a),console.log("\uD83D\uDCDD Phase 4: Final Content Generation");let b=await this.assembleFinalContent(a);this.status.content=b,await this.storage.saveFinalContent(this.id,b),console.log("✅ Phase 5: Final Quality Assessment");try{await this.runFinalQualityControl(a)}catch(a){console.warn("Quality control failed, using default scores:",a),this.status.qualityScores={overall:.8,content:.8,seo:.75,engagement:.8,brand:.75}}this.status.status="completed",this.status.endTime=new Date,this.status.progress=100;let c=this.status.endTime.getTime()-this.status.startTime.getTime();console.log(`🎉 Enhanced workflow completed in ${Math.round(c/1e3)}s`)}catch(a){if(console.error("Enhanced workflow failed:",a),this.options.enableFallbacks){if(console.log("\uD83D\uDD27 Attempting error recovery..."),!await this.attemptErrorRecovery(a))throw this.status.status="failed",this.status.error=a instanceof Error?a.message:"Unknown error",a}else throw this.status.status="failed",this.status.error=a instanceof Error?a.message:"Unknown error",a}}updateAgentProgress(a,b){let c=this.status.agents.findIndex(b=>b.agentId===a);-1!==c&&(this.status.agents[c].progress=b,100===b?(this.status.agents[c].status="completed",this.status.agents[c].endTime=new Date):b>0&&(this.status.agents[c].status="running",this.status.agents[c].startTime||(this.status.agents[c].startTime=new Date)));let d=this.status.agents.reduce((a,b)=>a+b.progress,0);this.status.progress=Math.round(d/this.status.agents.length);let e=this.status.agents.find(a=>"running"===a.status);this.status.currentAgent=e?.agentId}async storeIntermediateResults(a){for(let[b,c]of a)await this.storage.saveAgentOutput(this.id,b,c)}async assembleFinalContent(a){let b=Object.fromEntries(a),c={id:`enhanced-content-${this.id}`,title:this.extractTitle(b),content:this.extractMainContent(b),summary:this.extractSummary(b),seoKeywords:this.extractSEOKeywords(b),readabilityScore:this.calculateReadabilityScore(b),platforms:this.generatePlatformContent(b),metadata:{contentType:this.request.contentType,generationMethod:"enhanced-background-workflow",totalAgents:a.size,executionTime:Date.now()-this.status.startTime.getTime(),qualityMode:this.options.priorityMode||"balanced"}};return console.log(`📝 Assembled final content: ${c.title}`),c}async runFinalQualityControl(a){if(!this.status.content)return;let b=new Promise((a,b)=>setTimeout(()=>b(Error("Quality control timeout")),3e4));try{await Promise.race([b,this.performQualityControl(a)])}catch(a){throw console.warn("Quality control failed or timed out:",a),a}}async performQualityControl(a){try{let b=new Map;for(let[c,d]of a){let e=await this.evaluator.evaluateAgentOutput(c,d,this.request,{previousOutputs:Object.fromEntries(a)});b.set(c,e)}let c=await this.evaluator.generateQualityReport(b);this.status.qualityScores={overall:c.overallScore,content:c.overallScore,seo:this.calculateAvgMetric(b,"seoOptimization"),engagement:this.calculateAvgMetric(b,"engagementPotential"),brand:this.calculateAvgMetric(b,"brandAlignment")},await this.storage.saveQualityReport(this.id,c),console.log(`📊 Quality assessment completed - Overall score: ${Math.round(100*c.overallScore)}%`)}catch(a){console.warn("Quality control failed, using default scores:",a),this.status.qualityScores={overall:.75,content:.75,seo:.75,engagement:.75,brand:.75}}}calculateAvgMetric(a,b){let c=Array.from(a.values()).map(a=>a.metrics[b]).filter(a=>"number"==typeof a);return c.length>0?c.reduce((a,b)=>a+b,0)/c.length:.75}async attemptErrorRecovery(a){console.log("\uD83D\uDD27 Attempting workflow-level error recovery...");try{let b=await this.errorRecovery.handleError("workflow",a,this.request,{status:this.status},1,2);if(b.recovered&&b.result)return console.log("✅ Workflow recovery successful"),this.status.content=b.result,this.status.status="completed",this.status.endTime=new Date,this.status.progress=100,!0;return!1}catch(a){return console.error("Error recovery failed:",a),!1}}extractTitle(a){return a["content-strategist"]?.outline?.title||a["content-writer"]?.content?.title||`${this.request.contentType} about ${this.request.topic}`}extractMainContent(a){let b=a["content-writer"];if(b?.content){let a=b.content.introduction||"";return b.content.mainContent&&b.content.mainContent.forEach(b=>{a+=`

## ${b.heading}
`,b.paragraphs&&(a+=b.paragraphs.join("\n\n"))}),b.content.conclusion&&(a+=`

## Conclusion
${b.content.conclusion}`),a}return`Content about ${this.request.topic}`}extractSummary(a){return a["content-strategist"]?.strategy?.summary||a["content-writer"]?.content?.introduction?.substring(0,200)+"..."}extractSEOKeywords(a){return a["ai-seo-optimizer"]?.keywordStrategy?.primaryKeywords?.map(a=>a.keyword)||a["ai-seo-optimizer"]?.keywords||[this.request.topic]}calculateReadabilityScore(a){return a["content-writer"]?.metadata?.readabilityScore||a["content-editor"]?.readabilityScore||75}generatePlatformContent(a){let b=[];return a["social-media-specialist"]?.platforms&&b.push(...a["social-media-specialist"].platforms),a["landing-page-specialist"]&&b.push({platform:"landing-page",content:a["landing-page-specialist"].content,mediaRecommendations:a["landing-page-specialist"].mediaRecommendations}),b}async getStatus(){return{...this.status}}async getContent(){return this.status.content}async getQualityScores(){return this.status.qualityScores}async getExecutionStats(){return{duration:(this.status.endTime||new Date).getTime()-this.status.startTime.getTime(),agentStats:this.orchestrator.getExecutionStats(),qualityMetrics:this.status.qualityScores,errorRecoveryStats:this.errorRecovery.getErrorAnalytics()}}async getDetailedReport(){let a=await this.getExecutionStats();return{workflowId:this.id,request:this.request,options:this.options,status:this.status,executionStats:a,recommendations:this.generateRecommendations(a)}}generateRecommendations(a){let b=[];return a.duration>1e3*(this.options.maxExecutionTime||900)&&b.push("Consider using speed priority mode for faster execution"),a.qualityMetrics?.overall<.8&&b.push("Consider using quality priority mode for better results"),a.errorRecoveryStats?.totalErrors>0&&b.push("Review error patterns and consider system optimization"),a.agentStats?.successRate<.9&&b.push("Some agents may need optimization or alternative strategies"),b}async executeWorkflowInBackground(a){try{this.id=a,this.status.status="running",this.status.startTime=new Date,console.log(`🔄 Starting background enhanced workflow execution for ${this.request.contentType}`),console.log("\uD83D\uDCCB Phase 1: Dynamic Task Planning"),this.delegator.delegateTasks(this.request,this.options.maxExecutionTime,this.options.priorityMode),console.log("\uD83D\uDD04 Phase 2: Enhanced Agent Execution");let b=await this.orchestrator.executeWorkflow(this.request,(a,b)=>{this.updateAgentProgress(a,b)});await this.storeIntermediateResults(b),console.log("\uD83D\uDCDD Phase 4: Final Content Assembly");let c=await this.assembleFinalContent(b),d=await this.evaluator.calculateQualityScores(c,this.request,b);this.status.content=c,this.status.qualityScores=d,this.status.status="completed",this.status.endTime=new Date,this.status.progress=100,this.status.agents.forEach(a=>{a.status="completed",a.progress=100}),await this.updatePersistedStatus(),console.log(`✅ Background workflow ${a} completed successfully`)}catch(b){console.error(`❌ Background workflow ${a} failed:`,b),await this.markAsFailed(b instanceof Error?b.message:"Unknown error")}}async markAsFailed(a){this.status.status="failed",this.status.error=a,this.status.endTime=new Date,this.status.agents.forEach(a=>{"running"===a.status&&(a.status="failed")}),await this.updatePersistedStatus()}async simulateDemoWorkflow(a){try{this.id=a,this.status.status="running",this.status.startTime=new Date,console.log(`🎭 Starting demo workflow simulation for ${a}`);let b=["market-researcher","content-strategist","content-writer","ai-seo-optimizer","content-editor"];for(let a=0;a<b.length;a++){let c=b[a],d=this.status.agents.findIndex(a=>a.agentId===c);if(-1!==d){this.status.agents[d].status="running",this.status.agents[d].progress=0;let c=(5e3+5e3*Math.random())/10;for(let e=0;e<=10;e++)await new Promise(a=>setTimeout(a,c)),this.status.agents[d].progress=Math.round(e/10*100),this.status.progress=Math.round((10*a+e)/(10*b.length)*100);this.status.agents[d].status="completed"}}let c=this.generateDemoContent();this.status.content=c,this.status.qualityScores={overall:.85,content:.88,seo:.82,engagement:.87,brand:.83},this.status.status="completed",this.status.endTime=new Date,this.status.progress=100,await this.updatePersistedStatus(),console.log(`✅ Demo workflow ${a} completed`)}catch(b){console.error(`❌ Demo workflow ${a} failed:`,b),await this.markAsFailed(b instanceof Error?b.message:"Demo workflow failed")}}generateDemoContent(){return{id:`demo-content-${Date.now()}`,title:`The Future of ${this.request.topic}: A Complete Guide`,content:`# The Future of ${this.request.topic}: A Complete Guide

## Introduction
${this.request.topic} is transforming the way ${this.request.audience} approach their work and achieve their goals.

## Key Benefits
- **Enhanced Efficiency**: Streamlined processes that save time and resources
- **Better Results**: Proven strategies that deliver measurable outcomes  
- **Competitive Advantage**: Stay ahead with cutting-edge approaches
- **Scalable Solutions**: Growth-ready implementations

## Implementation Strategy
1. Start with clear objectives aligned with your goals
2. Implement proven methodologies step by step
3. Monitor progress and optimize continuously
4. Scale successful approaches across your organization

## Best Practices
- Focus on data-driven decision making
- Maintain consistent quality standards
- Invest in team training and development
- Stay updated with industry trends

## Conclusion
The integration of ${this.request.topic} represents a significant opportunity for ${this.request.audience} to achieve their goals and drive meaningful results.

*Ready to get started? Contact our team to learn more about implementing these strategies for your organization.*`,summary:`Comprehensive guide to ${this.request.topic} for ${this.request.audience} with actionable strategies and best practices.`,seoKeywords:[this.request.topic.toLowerCase(),"best practices","implementation","strategy"],readabilityScore:85,platforms:"social"===this.request.contentType?["LinkedIn","Twitter","Facebook"]:[],metadata:{contentType:this.request.contentType,generationMethod:"demo-mode",totalAgents:5,executionTime:6e4,qualityMode:"demo"}}}updateAgentProgress(a,b){let c=this.status.agents.findIndex(b=>b.agentId===a);-1!==c&&(this.status.agents[c].progress=b,100===b?this.status.agents[c].status="completed":b>0&&(this.status.agents[c].status="running"));let d=this.status.agents.reduce((a,b)=>a+b.progress,0);this.status.progress=Math.round(d/this.status.agents.length),this.updatePersistedStatus().catch(console.error)}extractTitle(a){return a["content-writer"]?.content?.title?a["content-writer"].content.title:a["content-strategist"]?.outline?.title?a["content-strategist"].outline.title:`${this.request.topic}: A Comprehensive Guide`}extractMainContent(a){return a["content-writer"]?.content?.mainContent?a["content-writer"].content.mainContent.map(a=>{let b=`## ${a.heading}

`;return a.paragraphs&&(b+=a.paragraphs.join("\n\n")+"\n\n"),a.bulletPoints&&a.bulletPoints.length>0&&(b+=a.bulletPoints.map(a=>`- ${a}`).join("\n")+"\n\n"),b}).join(""):`# ${this.request.topic}

Comprehensive content about ${this.request.topic} for ${this.request.audience}.`}extractSummary(a){return a["content-strategist"]?.strategy?.valueProposition?a["content-strategist"].strategy.valueProposition:`Complete guide to ${this.request.topic} for ${this.request.audience}`}extractSEOKeywords(a){return a["ai-seo-optimizer"]?.keywordStrategy?.primaryKeywords?a["ai-seo-optimizer"].keywordStrategy.primaryKeywords.map(a=>a.keyword||a):[this.request.topic.toLowerCase(),"best practices","guide"]}calculateReadabilityScore(a){return a["content-editor"]?.readabilityScore?a["content-editor"].readabilityScore:78}generatePlatformContent(a){return a["social-media-specialist"]?.platforms?a["social-media-specialist"].platforms:"social"===this.request.contentType?[{platform:"LinkedIn",content:`Professional insights on ${this.request.topic}`},{platform:"Twitter",content:`Quick tips about ${this.request.topic}`}]:[]}async persistStatus(){try{let a=await Promise.resolve().then(c.t.bind(c,29021,23)).then(a=>a.promises),b=(await Promise.resolve().then(c.t.bind(c,33873,23))).join("/tmp",`workflow-${this.id}.json`),d=JSON.stringify(this.status,null,2);await a.writeFile(b,d,"utf-8"),console.log(`💾 Persisted workflow status for ${this.id}`)}catch(a){console.error("Failed to persist workflow status:",a)}}async updatePersistedStatus(){await this.persistStatus()}}d()}catch(a){d(a)}})},29294:a=>{a.exports=require("next/dist/server/app-render/work-async-storage.external.js")},30007:(a,b,c)=>{c.a(a,async(a,d)=>{try{c.d(b,{r:()=>o});var e=c(82335),f=c(88617),g=c(7838),h=c(53232),i=c(46175),j=c(37873),k=c(69218),l=c(5199),m=c(73691),n=a([e,f,g,h,i,j,k,l,m]);[e,f,g,h,i,j,k,l,m]=n.then?(await n)():n;class o{constructor(){this.qualityThreshold=.8,this.maxExecutionTime=18e4,this.enableFastFail=!0,this.workers=new Map,this.taskGraph=new Map,this.executionHistory=[],this.activeExecutions=new Map,this.initializeWorkers(),this.buildTaskGraph()}initializeWorkers(){[["market-researcher",new e.b],["audience-analyzer",new f.P],["content-strategist",new g.q],["ai-seo-optimizer",new h.B],["content-writer",new i.J],["content-editor",new j.j],["social-media-specialist",new k.Z],["landing-page-specialist",new l.S],["performance-analyst",new m.p]].forEach(([a,b])=>{this.workers.set(a,{id:a,agent:b,isAvailable:!0,lastUsed:new Date(0)})})}buildTaskGraph(){[{id:"market-researcher",dependencies:[],priority:10,estimatedDuration:180,canRunInParallel:!0,retryCount:0,maxRetries:2},{id:"audience-analyzer",dependencies:[],priority:10,estimatedDuration:120,canRunInParallel:!0,retryCount:0,maxRetries:2},{id:"ai-seo-optimizer",dependencies:[],priority:8,estimatedDuration:90,canRunInParallel:!0,retryCount:0,maxRetries:2},{id:"content-strategist",dependencies:["market-researcher","audience-analyzer"],priority:9,estimatedDuration:150,canRunInParallel:!1,retryCount:0,maxRetries:3},{id:"content-writer",dependencies:["content-strategist","ai-seo-optimizer"],priority:9,estimatedDuration:240,canRunInParallel:!1,retryCount:0,maxRetries:3},{id:"content-editor",dependencies:["content-writer"],priority:8,estimatedDuration:120,canRunInParallel:!1,retryCount:0,maxRetries:2},{id:"social-media-specialist",dependencies:["content-strategist"],priority:6,estimatedDuration:90,canRunInParallel:!0,retryCount:0,maxRetries:2},{id:"landing-page-specialist",dependencies:["content-strategist"],priority:6,estimatedDuration:120,canRunInParallel:!0,retryCount:0,maxRetries:2},{id:"performance-analyst",dependencies:["content-editor"],priority:5,estimatedDuration:60,canRunInParallel:!0,retryCount:0,maxRetries:1}].forEach(a=>{let b=this.workers.get(a.id);b&&this.taskGraph.set(a.id,{...a,agent:b.agent})})}async executeWorkflow(a,b){let c=new Map,d=new Set,e=new Set;console.log("\uD83D\uDE80 Starting enhanced orchestrator workflow");let f=this.getReadyTasks(d);console.log(`📋 Phase 1: Executing ${f.length} parallel tasks`);let g=await this.executeTasksInParallel(f,a,c,b);for(this.processResults(g,d,e,c);d.size+e.size<this.taskGraph.size;){let f=this.getReadyTasks(d);if(0===f.length){let a=Array.from(this.taskGraph.keys()).filter(a=>!d.has(a)&&!e.has(a));console.warn("⚠️ No ready tasks found, remaining:",a);break}console.log(`📋 Next phase: Executing ${f.length} tasks`);let g=await this.executeTasksInParallel(f,a,c,b);this.processResults(g,d,e,c)}return console.log(`✅ Workflow completed: ${d.size} successful, ${e.size} failed`),c}getReadyTasks(a){return Array.from(this.taskGraph.values()).filter(b=>{let c=b.dependencies.every(b=>a.has(b)),d=!a.has(b.id),e=b.retryCount<b.maxRetries;return c&&d&&e}).sort((a,b)=>b.priority-a.priority)}async executeTasksInParallel(a,b,c,d){let e=a.filter(a=>a.canRunInParallel),f=a.filter(a=>!a.canRunInParallel),g=[];if(e.length>0){let a=e.map(a=>this.executeTask(a,b,c,d));(await Promise.allSettled(a)).forEach((a,b)=>{"fulfilled"===a.status?g.push(a.value):g.push({agentId:e[b].id,success:!1,error:a.reason?.message||"Unknown error",duration:0})})}for(let a of f)try{let e=await this.executeTask(a,b,c,d);g.push(e),e.success&&e.output&&c.set(e.agentId,e.output)}catch(b){g.push({agentId:a.id,success:!1,error:b instanceof Error?b.message:"Unknown error",duration:0})}return g}async executeTask(a,b,c,d){let e=Date.now(),f=this.workers.get(a.id);if(!f||!f.isAvailable)throw Error(`Worker ${a.id} not available`);f.isAvailable=!1,f.currentTask=a.id;let g=null;try{console.log(`🔄 Starting ${a.id} (attempt ${a.retryCount+1}/${a.maxRetries})`),d&&d(a.id,0);let f={request:b,previousOutputs:Object.fromEntries(c)};g=setInterval(()=>{if(d){let b=Date.now()-e,c=Math.min(b/(1e3*a.estimatedDuration)*100,90);d(a.id,c)}},2e3);let h=a.agent.execute(b,f),i=new Promise((b,c)=>{setTimeout(()=>{c(Error(`${a.id} execution timeout after ${this.maxExecutionTime}ms`))},this.maxExecutionTime)}),j=await Promise.race([h,i]);clearInterval(g),d&&d(a.id,100);let k=Date.now()-e;console.log(`✅ ${a.id} completed in ${k}ms`);let l=await this.assessOutputQuality(a.id,j,b),m={agentId:a.id,success:!0,output:j,duration:k,quality:l};return this.executionHistory.push(m),m}catch(i){let f=Date.now()-e;if(console.error(`❌ ${a.id} failed:`,i),g&&clearInterval(g),a.retryCount++,a.retryCount>=a.maxRetries&&this.enableFastFail){console.log(`🔄 ${a.id} exhausted retries, attempting fallback generation`);try{let e=await this.generateFallbackOutput(a.id,b,c);d&&d(a.id,100);let g={agentId:a.id,success:!0,output:e,duration:f,quality:.75};return console.log(`✅ ${a.id} completed with fallback`),this.executionHistory.push(g),g}catch(b){console.error(`❌ ${a.id} fallback also failed:`,b)}}let h={agentId:a.id,success:!1,error:i instanceof Error?i.message:"Unknown error",duration:f};return this.executionHistory.push(h),h}finally{f.isAvailable=!0,f.currentTask=void 0,f.lastUsed=new Date}}async generateFallbackOutput(a,b,c){console.log(`🔄 Generating fallback output for ${a}`);let d=b.topic,e=b.audience,f=b.contentType;switch(b.tone,a){case"market-researcher":return{industry:this.extractIndustryFromTopic(d),trends:[`Rising demand for ${d} solutions`,"Increased focus on digital transformation","Growing emphasis on data-driven strategies","Shift towards customer-centric approaches"],opportunities:[`Untapped market segments in ${d}`,"Technology integration opportunities","Partnership and collaboration potential","Innovation and product development areas"],threats:["Competitive market pressure","Rapidly changing technology landscape","Economic uncertainty factors","Regulatory compliance challenges"],keyInsights:[`${e} are actively seeking ${d} solutions`,"Market shows strong growth potential","Early movers have competitive advantage","Quality and innovation are key differentiators"],marketSize:"Large and growing market opportunity",competitiveAnalysis:"Moderate competition with room for differentiation"};case"audience-analyzer":return{primaryPersona:{name:`Professional ${e} Decision Maker`,demographics:{age:"35-55",income:"$75,000+",education:"College+",location:"Urban/Suburban"},psychographics:{values:["efficiency","innovation","results","quality"],interests:["industry trends","best practices","networking","continuous learning"],lifestyle:["busy professional","goal-oriented","tech-savvy","quality-focused"]},painPoints:[`Struggling with ${d} implementation`,"Limited time and resources","Need for proven solutions","Pressure to deliver results"],goals:[`Master ${d} effectively`,"Improve business outcomes","Stay competitive","Drive team success"],contentPreferences:["actionable insights","case studies","best practices","expert guidance"],platforms:["LinkedIn","industry publications","professional forums","email"]},audienceSize:"Large target market",engagementPatterns:"Active during business hours, responsive to valuable content"};case"content-strategist":return{strategy:{objectives:[`Educate ${e} about ${d}`,"Build authority and trust","Generate qualified leads"],keyMessages:[`${d} drives business success`,"Expert guidance ensures better results","Proven strategies deliver ROI","Innovation leads to competitive advantage"],valueProposition:`Transform your business with expert ${d} strategies tailored for ${e}`,callToAction:`Ready to excel with ${d}? Get started today.`},contentFramework:{hook:`Discover how ${d} can revolutionize your approach`,problemStatement:`${e} face significant challenges with ${d}`,solutionPresentation:"Comprehensive strategies and proven methodologies",benefitsHighlight:["improved efficiency","better results","competitive advantage","measurable ROI"],credibilityBuilders:["expert insights","proven track record","industry recognition"],urgencyCreators:["market opportunities","competitive pressure","limited-time benefits"]},outline:{title:`The Complete Guide to ${d} for ${e}`,sections:[{heading:`Understanding ${d} Fundamentals`,purpose:"Establish foundation knowledge",keyPoints:["core concepts","industry context","success factors"],estimatedWordCount:400},{heading:`Proven Strategies for ${e}`,purpose:"Provide actionable solutions",keyPoints:["best practices","implementation steps","common pitfalls"],estimatedWordCount:600},{heading:"Implementation and Results",purpose:"Guide practical application",keyPoints:["step-by-step process","measurement metrics","optimization tips"],estimatedWordCount:500}]}};case"ai-seo-optimizer":return{keywordStrategy:{primaryKeywords:[{keyword:d.toLowerCase(),searchVolume:5e3,difficulty:65},{keyword:`${d} for ${e}`,searchVolume:1200,difficulty:45},{keyword:`${d} guide`,searchVolume:2400,difficulty:55}],secondaryKeywords:[`${d} best practices`,`${d} strategies`,`${d} tips`,`${d} solutions`],longTailKeywords:[`how to implement ${d}`,`${d} for beginners`,`${d} case studies`,`${d} ROI analysis`]},onPageOptimization:{focusKeyphrase:d.toLowerCase(),keywordDensity:{target:2.5,secondary:1.8},h1Tag:`The Complete Guide to ${d} for ${e}`,h2Tags:[`Understanding ${d} Fundamentals`,`Proven Strategies for ${e}`,"Implementation and Results"],metaTitle:`${d} Guide for ${e} | Expert Strategies`,metaDescription:`Discover proven ${d} strategies for ${e}. Expert insights, actionable tips, and measurable results.`}};case"content-editor":return{editingSuggestions:["Enhance readability with shorter sentences","Add more specific examples and case studies","Strengthen call-to-action statements","Improve paragraph transitions"],readabilityScore:78,tonalConsistency:85,brandAlignment:82,factualAccuracy:90,revisionNotes:"Content meets quality standards with minor enhancements recommended"};case"performance-analyst":return{performanceMetrics:{readabilityScore:80,seoOptimization:85,engagementPotential:78,conversionLikelihood:75},recommendations:["Add more interactive elements","Include social proof testimonials","Optimize for mobile readability","Enhance visual content suggestions"],benchmarkComparison:"Above industry average",improvementOpportunities:["Increase emotional appeal","Add urgency elements","Strengthen value proposition","Optimize conversion paths"]};default:return{fallbackData:!0,agentId:a,message:`Fallback content generated for ${a}`,topic:d,audience:e,contentType:f,timestamp:new Date().toISOString()}}}extractIndustryFromTopic(a){let b=a.toLowerCase();if(b.includes("tech")||b.includes("software")||b.includes("ai"))return"Technology";if(b.includes("market")||b.includes("sales")||b.includes("business"))return"Business & Marketing";if(b.includes("health")||b.includes("medical")||b.includes("wellness"))return"Healthcare";if(b.includes("finance")||b.includes("investment")||b.includes("money"))return"Financial Services";if(b.includes("education")||b.includes("learning")||b.includes("training"))return"Education";else return"Professional Services"}async assessOutputQuality(a,b,c){try{let c=.5;return"content-writer"===a&&b.content&&(b.content.title&&b.content.title.length>10&&(c+=.1),b.content.mainContent&&b.content.mainContent.length>0&&(c+=.1),b.metadata&&b.metadata.wordCount>500&&(c+=.1),b.qualityMetrics&&b.qualityMetrics.originalityScore>80&&(c+=.1)),"market-researcher"===a&&b.industry&&b.trends&&(b.trends.length>=3&&(c+=.1),b.opportunities&&b.opportunities.length>=2&&(c+=.1)),"object"==typeof b&&Object.keys(b).length>3&&(c+=.1),Math.min(c,1)}catch(b){return console.warn(`Quality assessment failed for ${a}:`,b),.6}}processResults(a,b,c,d){a.forEach(a=>{if(a.success)b.add(a.agentId),a.output&&d.set(a.agentId,a.output),console.log(`✅ ${a.agentId} completed successfully`);else{let b=this.taskGraph.get(a.agentId);b&&b.retryCount<b.maxRetries?console.log(`🔄 ${a.agentId} will retry (${b.retryCount}/${b.maxRetries})`):(c.add(a.agentId),console.log(`❌ ${a.agentId} failed permanently`))}})}getExecutionStats(){if(0===this.executionHistory.length)return{totalExecutions:0,successRate:0,avgDuration:0,qualityScore:0};let a=this.executionHistory.filter(a=>a.success),b=this.executionHistory.reduce((a,b)=>a+b.duration,0)/this.executionHistory.length,c=a.filter(a=>void 0!==a.quality).reduce((a,b)=>a+(b.quality||0),0)/a.length;return{totalExecutions:this.executionHistory.length,successRate:a.length/this.executionHistory.length,avgDuration:Math.round(b),qualityScore:c||0}}async healthCheck(){let a=new Map,b=Array.from(this.workers.entries()).map(async([a,b])=>{try{return"function"==typeof b.agent.healthCheck&&await b.agent.healthCheck(),[a,!0]}catch(b){return console.error(`Health check failed for ${a}:`,b),[a,!1]}});return(await Promise.allSettled(b)).forEach(b=>{"fulfilled"===b.status&&a.set(b.value[0],b.value[1])}),a}}d()}catch(a){d(a)}})},33873:a=>{a.exports=require("path")},35221:(a,b,c)=>{c.d(b,{c:()=>d});class d{constructor(){this.taskDefinitions=new Map,this.delegationStrategies=new Map,this.initializeTaskDefinitions(),this.initializeDelegationStrategies()}initializeTaskDefinitions(){[{id:"market-research",name:"Market Research",description:"Analyze market trends and competitive landscape",agentId:"market-researcher",priority:9,dependencies:[],requiredForTypes:["blog","landing","email","whitepaper"],optionalForTypes:["social"],estimatedDuration:180,qualityWeight:.85},{id:"audience-analysis",name:"Audience Analysis",description:"Research target audience and create personas",agentId:"audience-analyzer",priority:9,dependencies:[],requiredForTypes:["landing","email","whitepaper"],optionalForTypes:["blog","social"],estimatedDuration:120,qualityWeight:.9},{id:"content-strategy",name:"Content Strategy",description:"Develop comprehensive content strategy and outline",agentId:"content-strategist",priority:8,dependencies:["market-research","audience-analysis"],requiredForTypes:["blog","landing","whitepaper"],optionalForTypes:["email","social"],estimatedDuration:150,qualityWeight:.95},{id:"seo-optimization",name:"SEO Optimization",description:"Optimize content for search engines and AI search",agentId:"ai-seo-optimizer",priority:7,dependencies:[],requiredForTypes:["blog","landing","whitepaper"],optionalForTypes:["email"],estimatedDuration:90,qualityWeight:.8},{id:"content-writing",name:"Content Writing",description:"Create engaging, conversion-focused content",agentId:"content-writer",priority:10,dependencies:["content-strategy","seo-optimization"],requiredForTypes:["blog","landing","email","whitepaper"],optionalForTypes:["social"],estimatedDuration:240,qualityWeight:1},{id:"content-editing",name:"Content Editing",description:"Review and polish content for quality and consistency",agentId:"content-editor",priority:8,dependencies:["content-writing"],requiredForTypes:["blog","landing","whitepaper"],optionalForTypes:["email","social"],estimatedDuration:120,qualityWeight:.85},{id:"social-adaptation",name:"Social Media Adaptation",description:"Adapt content for social media platforms",agentId:"social-media-specialist",priority:6,dependencies:["content-strategy"],requiredForTypes:["social"],optionalForTypes:["blog","landing"],estimatedDuration:90,qualityWeight:.75},{id:"landing-optimization",name:"Landing Page Optimization",description:"Optimize for conversion and user experience",agentId:"landing-page-specialist",priority:8,dependencies:["content-strategy"],requiredForTypes:["landing"],optionalForTypes:[],estimatedDuration:120,qualityWeight:.9},{id:"performance-analysis",name:"Performance Analysis",description:"Set up analytics and define success metrics",agentId:"performance-analyst",priority:5,dependencies:["content-editing"],requiredForTypes:[],optionalForTypes:["blog","landing","email","whitepaper","social"],estimatedDuration:60,qualityWeight:.7}].forEach(a=>{this.taskDefinitions.set(a.id,a)})}initializeDelegationStrategies(){[{contentType:"blog",requiredTasks:["market-research","content-strategy","seo-optimization","content-writing","content-editing"],optionalTasks:["audience-analysis","performance-analysis"],priorityModifiers:{"seo-optimization":1.5,"content-writing":1.3,"content-editing":1.2},qualityThresholds:{"content-writing":.85,"seo-optimization":.8,"content-editing":.8},timeConstraints:{maxDuration:900,prioritizeSpeed:!1}},{contentType:"landing",requiredTasks:["audience-analysis","content-strategy","seo-optimization","content-writing","landing-optimization"],optionalTasks:["market-research","content-editing","performance-analysis"],priorityModifiers:{"audience-analysis":1.5,"landing-optimization":1.4,"content-writing":1.3},qualityThresholds:{"audience-analysis":.9,"landing-optimization":.85,"content-writing":.85},timeConstraints:{maxDuration:720,prioritizeSpeed:!0}},{contentType:"social",requiredTasks:["social-adaptation"],optionalTasks:["market-research","audience-analysis","content-strategy","performance-analysis"],priorityModifiers:{"social-adaptation":2,"audience-analysis":1.3},qualityThresholds:{"social-adaptation":.8},timeConstraints:{maxDuration:300,prioritizeSpeed:!0}},{contentType:"email",requiredTasks:["audience-analysis","content-writing"],optionalTasks:["market-research","content-strategy","seo-optimization","content-editing","performance-analysis"],priorityModifiers:{"audience-analysis":1.6,"content-writing":1.4},qualityThresholds:{"audience-analysis":.85,"content-writing":.8},timeConstraints:{maxDuration:480,prioritizeSpeed:!0}},{contentType:"whitepaper",requiredTasks:["market-research","audience-analysis","content-strategy","seo-optimization","content-writing","content-editing"],optionalTasks:["performance-analysis"],priorityModifiers:{"market-research":1.4,"content-strategy":1.5,"content-writing":1.3,"content-editing":1.3},qualityThresholds:{"market-research":.85,"content-strategy":.9,"content-writing":.9,"content-editing":.85},timeConstraints:{maxDuration:1200,prioritizeSpeed:!1}}].forEach(a=>{this.delegationStrategies.set(a.contentType,a)})}delegateTasks(a,b,c){let d=a.contentType,e=this.delegationStrategies.get(d);if(!e)throw Error(`No delegation strategy found for content type: ${d}`);let f=this.adaptStrategy(e,a,b,c),g=this.selectTasks(f,a),h=this.calculatePriorityOrder(g,f,a),i=this.groupTasksForParallelExecution(h),j=this.calculateEstimatedDuration(i);return console.log(`🎯 Task delegation for ${d}:`,{selectedTasksCount:g.length,estimatedDuration:`${Math.round(j/60)}m`,parallelGroupsCount:i.length}),{selectedTasks:g,estimatedDuration:j,priorityOrder:h,parallelGroups:i,adaptedStrategy:f}}adaptStrategy(a,b,c,d){let e=JSON.parse(JSON.stringify(a));switch(c&&c<a.timeConstraints.maxDuration&&(e.timeConstraints.maxDuration=c,e.timeConstraints.prioritizeSpeed=!0,c<.7*a.timeConstraints.maxDuration&&(e.optionalTasks=e.optionalTasks.slice(0,Math.floor(e.optionalTasks.length/2)))),d){case"speed":e.timeConstraints.prioritizeSpeed=!0,Object.keys(e.qualityThresholds).forEach(a=>{e.qualityThresholds[a]*=.9}),e.optionalTasks=e.optionalTasks.slice(0,1);break;case"quality":e.timeConstraints.prioritizeSpeed=!1,Object.keys(e.qualityThresholds).forEach(a=>{e.qualityThresholds[a]=Math.min(.95,1.1*e.qualityThresholds[a])}),e.optionalTasks=Array.from(new Set([...e.optionalTasks,...this.getQualityEnhancingTasks(b.contentType)]))}return b.audience&&b.audience.toLowerCase().includes("technical")&&(e.priorityModifiers["market-research"]=1.2*(e.priorityModifiers["market-research"]||1),e.qualityThresholds["market-research"]=Math.min(.95,1.1*(e.qualityThresholds["market-research"]||.8))),b.goals&&Array.isArray(b.goals)&&b.goals.some(a=>a.toLowerCase().includes("seo"))&&(e.priorityModifiers["seo-optimization"]=1.3*(e.priorityModifiers["seo-optimization"]||1),e.qualityThresholds["seo-optimization"]=Math.min(.95,1.1*(e.qualityThresholds["seo-optimization"]||.8))),e}selectTasks(a,b){let c=[];return a.requiredTasks.forEach(a=>{let b=this.taskDefinitions.get(a);b&&c.push(b)}),this.selectOptionalTasks(a,b).forEach(a=>{let b=this.taskDefinitions.get(a);b&&c.push(b)}),c}selectOptionalTasks(a,b){let c=[],d=a.timeConstraints.maxDuration-this.calculateRequiredTasksTime(a.requiredTasks);if(d<=0)return c;let e=a.optionalTasks.map(b=>{let c=this.taskDefinitions.get(b);if(!c)return null;let e=d/c.estimatedDuration,f=c.qualityWeight,g=a.priorityModifiers[b]||1;return{taskId:b,score:.4*e+.4*f+.2*g,duration:c.estimatedDuration}}).filter(Boolean);e.sort((a,b)=>b.score-a.score);let f=0;for(let a of e)f+a.duration<=d&&(c.push(a.taskId),f+=a.duration);return c}calculateRequiredTasksTime(a){return a.reduce((a,b)=>{let c=this.taskDefinitions.get(b);return a+(c?.estimatedDuration||0)},0)}calculatePriorityOrder(a,b,c){return a.slice().sort((a,c)=>{let d=b.priorityModifiers[a.id]||1,e=b.priorityModifiers[c.id]||1,f=a.priority*d,g=c.priority*e;return f!==g?g-f:a.qualityWeight!==c.qualityWeight?c.qualityWeight-a.qualityWeight:b.timeConstraints.prioritizeSpeed?a.estimatedDuration-c.estimatedDuration:0})}groupTasksForParallelExecution(a){let b=[],c=new Set;for(;c.size<a.length;){let d=[];for(let b of a)!c.has(b.id)&&b.dependencies.every(a=>c.has(a))&&(d.push(b),c.add(b.id));if(0===d.length){console.warn("Circular dependency detected or no more tasks can be executed");break}b.push(d)}return b}calculateEstimatedDuration(a){return a.reduce((a,b)=>a+Math.max(...b.map(a=>a.estimatedDuration)),0)}getQualityEnhancingTasks(a){let b=["content-editing","performance-analysis"];switch(a){case"blog":case"whitepaper":return[...b,"market-research"];case"landing":return[...b,"audience-analysis"];case"email":return["content-editing"];case"social":return["performance-analysis"];default:return b}}getStrategyRecommendations(a){let b=a.contentType;if(!this.delegationStrategies.get(b))throw Error(`No strategy found for content type: ${b}`);let c=this.delegateTasks(a),d=c.selectedTasks.reduce((a,b)=>a+b.qualityWeight,0)/c.selectedTasks.length,e=[{name:"Speed Optimized",duration:.6*c.estimatedDuration,quality:.85*d,description:"Faster execution with minimal quality impact"},{name:"Quality Optimized",duration:1.4*c.estimatedDuration,quality:1.15*d,description:"Maximum quality with extended processing time"},{name:"Balanced",duration:c.estimatedDuration,quality:d,description:"Optimal balance of speed and quality"}];return{recommendedStrategy:"Balanced",estimatedDuration:c.estimatedDuration,qualityScore:d,alternativeStrategies:e}}}},44870:a=>{a.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},47821:(a,b,c)=>{c.a(a,async(a,d)=>{try{c.r(b),c.d(b,{GET:()=>k,POST:()=>j,maxDuration:()=>m,runtime:()=>l});var e=c(32190),f=c(15418),g=c(29231),h=c(87593),i=a([f,g]);[f,g]=i.then?(await i)():i;let l="nodejs",m=300;async function j(a){try{let b=await a.json();if(!b.contentType||!b.topic||!b.audience||!b.goals)return e.NextResponse.json({error:"Missing required fields: contentType, topic, audience, goals"},{status:400});let c=`enhanced-workflow-${Date.now()}-${Math.random().toString(36).substr(2,9)}`;if(!h.$.anthropicApiKey)return console.log("\uD83C\uDFAD Using Demo Mode - ANTHROPIC_API_KEY not configured"),setTimeout(async()=>{try{let a=new g.X(b,{demoMode:!0});await a.simulateDemoWorkflow(c)}catch(a){console.error("Demo workflow simulation failed:",a)}},100),e.NextResponse.json({workflowId:c,status:"started",workflowType:"demo",estimatedTime:60,agents:[{agentId:"market-researcher",status:"pending",progress:0},{agentId:"content-strategist",status:"pending",progress:0},{agentId:"content-writer",status:"pending",progress:0},{agentId:"ai-seo-optimizer",status:"pending",progress:0},{agentId:"content-editor",status:"pending",progress:0}],options:{priorityMode:"demo",enableOptimization:!1,demoMode:!0}});let d={priorityMode:b.priorityMode||"balanced",maxExecutionTime:b.maxExecutionTime||900,enableOptimization:!1!==b.enableOptimization,maxOptimizationCycles:b.maxOptimizationCycles||2,enableFallbacks:!1!==b.enableFallbacks};console.log("\uD83D\uDE80 Starting Background Content Workflow");let f=new g.X(b,d);return g.X.setInstance(c,f),await f.persistStatus(),setTimeout(async()=>{try{console.log(`🔄 Starting background processing for workflow ${c}`),await f.executeWorkflowInBackground(c),console.log(`✅ Background processing completed for workflow ${c}`)}catch(a){console.error(`❌ Background processing failed for workflow ${c}:`,a),f.markAsFailed(a instanceof Error?a.message:"Unknown error")}},100),e.NextResponse.json({workflowId:c,status:"started",workflowType:"enhanced-background",estimatedTime:d.maxExecutionTime/60,agents:[{agentId:"market-researcher",status:"pending",progress:0},{agentId:"audience-analyzer",status:"pending",progress:0},{agentId:"ai-seo-optimizer",status:"pending",progress:0},{agentId:"content-strategist",status:"pending",progress:0},{agentId:"content-writer",status:"pending",progress:0},{agentId:"content-editor",status:"pending",progress:0},{agentId:"social-media-specialist",status:"pending",progress:0},{agentId:"landing-page-specialist",status:"pending",progress:0},{agentId:"performance-analyst",status:"pending",progress:0}],options:d},{status:202})}catch(a){return console.error("Content generation startup error:",a),e.NextResponse.json({error:"Failed to start content generation"},{status:500})}}async function k(a){try{let{searchParams:b}=new URL(a.url),c=b.get("workflowId");if(!c)return e.NextResponse.json({error:"Missing workflowId parameter"},{status:400});console.log(`📊 Status check for workflow: ${c}`);let d=g.X.getInstance(c);if(d){let a=await d.getStatus();return console.log(`📊 Enhanced workflow status: ${a.status}, progress: ${a.progress}%`),e.NextResponse.json({...a,workflowType:"enhanced-background"})}try{let a=await g.X.loadPersistedStatus(c);if(a)return console.log(`📊 Loaded persisted workflow status: ${a.status}, progress: ${a.progress}%`),e.NextResponse.json({...a,workflowType:"enhanced-background"})}catch(a){console.error("Failed to load persisted status:",a)}if(!h.$.anthropicApiKey)return console.log("\uD83C\uDFAD No API key - returning demo content"),e.NextResponse.json({id:c,status:"completed",progress:100,workflowType:"demo",agents:[{agentId:"market-researcher",status:"completed",progress:100},{agentId:"content-strategist",status:"completed",progress:100},{agentId:"content-writer",status:"completed",progress:100},{agentId:"ai-seo-optimizer",status:"completed",progress:100},{agentId:"content-editor",status:"completed",progress:100}],startTime:new Date(Date.now()-6e4),endTime:new Date,estimatedTimeRemaining:0,content:{id:"demo-content",title:"Demo Content: AI-Powered Marketing Revolution",content:`# The Future of AI-Powered Marketing

## Introduction
Artificial Intelligence is transforming the marketing landscape, offering unprecedented opportunities for businesses to connect with their audiences in meaningful ways.

## Key Benefits
- **Personalization at Scale**: AI enables hyper-personalized content delivery
- **Data-Driven Insights**: Advanced analytics reveal customer behavior patterns  
- **Automation Efficiency**: Streamlined workflows increase productivity
- **ROI Optimization**: Smart budget allocation maximizes campaign effectiveness

## Implementation Strategies
1. Start with clear objectives and KPIs
2. Integrate AI tools gradually into existing workflows
3. Train teams on new technologies and processes
4. Monitor performance and optimize continuously

## Conclusion
The integration of AI in marketing represents a paradigm shift that forward-thinking businesses cannot afford to ignore. By embracing these technologies now, companies position themselves for sustained growth and competitive advantage.

*Ready to transform your marketing with AI? Contact us to learn more about our comprehensive solutions.*`,summary:"Comprehensive guide to implementing AI-powered marketing strategies for modern businesses.",seoKeywords:["AI marketing","digital transformation","marketing automation","data analytics"],readabilityScore:85,platforms:[],metadata:{contentType:"blog",generationMethod:"demo-mode",totalAgents:5,executionTime:6e4,qualityMode:"demo"}},qualityScores:{overall:.9,content:.88,seo:.92,engagement:.87,brand:.85}});let i=f.n.getInstance(c);if(i){let a=await i.getStatus();return e.NextResponse.json({...a,workflowType:"legacy"})}let j=c.match(/(\d+)/)?.[1];if(j){let a=parseInt(j);if(Date.now()-a<3e4)return console.log(`⏳ Workflow ${c} is initializing...`),e.NextResponse.json({id:c,status:"running",progress:5,workflowType:"enhanced-background",agents:[{agentId:"market-researcher",status:"pending",progress:0},{agentId:"audience-analyzer",status:"pending",progress:0},{agentId:"ai-seo-optimizer",status:"pending",progress:0},{agentId:"content-strategist",status:"pending",progress:0},{agentId:"content-writer",status:"pending",progress:0},{agentId:"content-editor",status:"pending",progress:0},{agentId:"social-media-specialist",status:"pending",progress:0},{agentId:"landing-page-specialist",status:"pending",progress:0},{agentId:"performance-analyst",status:"pending",progress:0}],startTime:new Date(a),estimatedTimeRemaining:900})}return console.log(`❌ Workflow ${c} not found`),e.NextResponse.json({error:"Workflow not found"},{status:404})}catch(a){return console.error("Workflow status error:",a),e.NextResponse.json({error:"Failed to get workflow status"},{status:500})}}d()}catch(a){d(a)}})},50489:(a,b,c)=>{c.a(a,async(a,d)=>{try{c.r(b),c.d(b,{handler:()=>x,patchFetch:()=>w,routeModule:()=>y,serverHooks:()=>B,workAsyncStorage:()=>z,workUnitAsyncStorage:()=>A});var e=c(96559),f=c(48088),g=c(37719),h=c(26191),i=c(81289),j=c(261),k=c(92603),l=c(39893),m=c(14823),n=c(47220),o=c(66946),p=c(47912),q=c(99786),r=c(46143),s=c(86439),t=c(43365),u=c(47821),v=a([u]);u=(v.then?(await v)():v)[0];let y=new e.AppRouteRouteModule({definition:{kind:f.RouteKind.APP_ROUTE,page:"/api/content/generate/route",pathname:"/api/content/generate",filename:"route",bundlePath:"app/api/content/generate/route"},distDir:".next",projectDir:"",resolvedPagePath:"/Users/jonathonc/Auto1111/claude/marketing-agent-v2/agentic-marketing-generator/src/app/api/content/generate/route.ts",nextConfigOutput:"standalone",userland:u}),{workAsyncStorage:z,workUnitAsyncStorage:A,serverHooks:B}=y;function w(){return(0,g.patchFetch)({workAsyncStorage:z,workUnitAsyncStorage:A})}async function x(a,b,c){var d;let e="/api/content/generate/route";"/index"===e&&(e="/");let g=await y.prepare(a,b,{srcPage:e,multiZoneDraftMode:"false"});if(!g)return b.statusCode=400,b.end("Bad Request"),null==c.waitUntil||c.waitUntil.call(c,Promise.resolve()),null;let{buildId:u,params:v,nextConfig:w,isDraftMode:x,prerenderManifest:z,routerServerContext:A,isOnDemandRevalidate:B,revalidateOnlyGenerated:C,resolvedPathname:D}=g,E=(0,j.normalizeAppPath)(e),F=!!(z.dynamicRoutes[E]||z.routes[D]);if(F&&!x){let a=!!z.routes[D],b=z.dynamicRoutes[E];if(b&&!1===b.fallback&&!a)throw new s.NoFallbackError}let G=null;!F||y.isDev||x||(G=D,G="/index"===G?"/":G);let H=!0===y.isDev||!F,I=F&&!H,J=a.method||"GET",K=(0,i.getTracer)(),L=K.getActiveScopeSpan(),M={params:v,prerenderManifest:z,renderOpts:{experimental:{dynamicIO:!!w.experimental.dynamicIO,authInterrupts:!!w.experimental.authInterrupts},supportsDynamicResponse:H,incrementalCache:(0,h.getRequestMeta)(a,"incrementalCache"),cacheLifeProfiles:null==(d=w.experimental)?void 0:d.cacheLife,isRevalidate:I,waitUntil:c.waitUntil,onClose:a=>{b.on("close",a)},onAfterTaskError:void 0,onInstrumentationRequestError:(b,c,d)=>y.onRequestError(a,b,d,A)},sharedContext:{buildId:u}},N=new k.NodeNextRequest(a),O=new k.NodeNextResponse(b),P=l.NextRequestAdapter.fromNodeNextRequest(N,(0,l.signalFromNodeResponse)(b));try{let d=async c=>y.handle(P,M).finally(()=>{if(!c)return;c.setAttributes({"http.status_code":b.statusCode,"next.rsc":!1});let d=K.getRootSpanAttributes();if(!d)return;if(d.get("next.span_type")!==m.BaseServerSpan.handleRequest)return void console.warn(`Unexpected root span type '${d.get("next.span_type")}'. Please report this Next.js issue https://github.com/vercel/next.js`);let e=d.get("next.route");if(e){let a=`${J} ${e}`;c.setAttributes({"next.route":e,"http.route":e,"next.span_name":a}),c.updateName(a)}else c.updateName(`${J} ${a.url}`)}),g=async g=>{var i,j;let k=async({previousCacheEntry:f})=>{try{if(!(0,h.getRequestMeta)(a,"minimalMode")&&B&&C&&!f)return b.statusCode=404,b.setHeader("x-nextjs-cache","REVALIDATED"),b.end("This page could not be found"),null;let e=await d(g);a.fetchMetrics=M.renderOpts.fetchMetrics;let i=M.renderOpts.pendingWaitUntil;i&&c.waitUntil&&(c.waitUntil(i),i=void 0);let j=M.renderOpts.collectedTags;if(!F)return await (0,o.I)(N,O,e,M.renderOpts.pendingWaitUntil),null;{let a=await e.blob(),b=(0,p.toNodeOutgoingHttpHeaders)(e.headers);j&&(b[r.NEXT_CACHE_TAGS_HEADER]=j),!b["content-type"]&&a.type&&(b["content-type"]=a.type);let c=void 0!==M.renderOpts.collectedRevalidate&&!(M.renderOpts.collectedRevalidate>=r.INFINITE_CACHE)&&M.renderOpts.collectedRevalidate,d=void 0===M.renderOpts.collectedExpire||M.renderOpts.collectedExpire>=r.INFINITE_CACHE?void 0:M.renderOpts.collectedExpire;return{value:{kind:t.CachedRouteKind.APP_ROUTE,status:e.status,body:Buffer.from(await a.arrayBuffer()),headers:b},cacheControl:{revalidate:c,expire:d}}}}catch(b){throw(null==f?void 0:f.isStale)&&await y.onRequestError(a,b,{routerKind:"App Router",routePath:e,routeType:"route",revalidateReason:(0,n.c)({isRevalidate:I,isOnDemandRevalidate:B})},A),b}},l=await y.handleResponse({req:a,nextConfig:w,cacheKey:G,routeKind:f.RouteKind.APP_ROUTE,isFallback:!1,prerenderManifest:z,isRoutePPREnabled:!1,isOnDemandRevalidate:B,revalidateOnlyGenerated:C,responseGenerator:k,waitUntil:c.waitUntil});if(!F)return null;if((null==l||null==(i=l.value)?void 0:i.kind)!==t.CachedRouteKind.APP_ROUTE)throw Object.defineProperty(Error(`Invariant: app-route received invalid cache entry ${null==l||null==(j=l.value)?void 0:j.kind}`),"__NEXT_ERROR_CODE",{value:"E701",enumerable:!1,configurable:!0});(0,h.getRequestMeta)(a,"minimalMode")||b.setHeader("x-nextjs-cache",B?"REVALIDATED":l.isMiss?"MISS":l.isStale?"STALE":"HIT"),x&&b.setHeader("Cache-Control","private, no-cache, no-store, max-age=0, must-revalidate");let m=(0,p.fromNodeOutgoingHttpHeaders)(l.value.headers);return(0,h.getRequestMeta)(a,"minimalMode")&&F||m.delete(r.NEXT_CACHE_TAGS_HEADER),!l.cacheControl||b.getHeader("Cache-Control")||m.get("Cache-Control")||m.set("Cache-Control",(0,q.getCacheControlHeader)(l.cacheControl)),await (0,o.I)(N,O,new Response(l.value.body,{headers:m,status:l.value.status||200})),null};L?await g(L):await K.withPropagatedContext(a.headers,()=>K.trace(m.BaseServerSpan.handleRequest,{spanName:`${J} ${a.url}`,kind:i.SpanKind.SERVER,attributes:{"http.method":J,"http.target":a.url}},g))}catch(b){if(L||b instanceof s.NoFallbackError||await y.onRequestError(a,b,{routerKind:"App Router",routePath:E,routeType:"route",revalidateReason:(0,n.c)({isRevalidate:I,isOnDemandRevalidate:B})}),F)throw b;return await (0,o.I)(N,O,new Response(null,{status:500})),null}}d()}catch(a){d(a)}})},50832:a=>{a.exports=import("@anthropic-ai/sdk")},63033:a=>{a.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},70955:(a,b,c)=>{c.d(b,{N:()=>d});class d{constructor(){this.fallbackStrategies=new Map,this.errorHistory=new Map,this.successRates=new Map,this.initializeFallbackStrategies()}initializeFallbackStrategies(){[{id:"simplified-prompt",name:"Simplified Prompt Strategy",description:"Use a simpler, more direct prompt to reduce complexity",applicableAgents:["content-writer","content-strategist","market-researcher"],applicableErrors:["timeout","parsing_error","invalid_response"],priority:1,execute:this.executeSimplifiedPrompt.bind(this)},{id:"template-fallback",name:"Template-Based Fallback",description:"Use pre-defined templates when AI generation fails",applicableAgents:["content-writer","content-editor","social-media-specialist"],applicableErrors:["api_error","timeout","invalid_response"],priority:2,execute:this.executeTemplateFallback.bind(this)},{id:"reduced-scope",name:"Reduced Scope Strategy",description:"Generate content with reduced requirements and scope",applicableAgents:["content-writer","market-researcher","audience-analyzer"],applicableErrors:["timeout","rate_limit","resource_exhausted"],priority:3,execute:this.executeReducedScope.bind(this)},{id:"alternative-agent",name:"Alternative Agent Strategy",description:"Use a different agent or simplified version for the task",applicableAgents:["content-strategist","ai-seo-optimizer","performance-analyst"],applicableErrors:["agent_specific_error","persistent_failure"],priority:4,execute:this.executeAlternativeAgent.bind(this)},{id:"cached-response",name:"Cached Response Strategy",description:"Use previously successful responses adapted to current context",applicableAgents:["market-researcher","audience-analyzer","ai-seo-optimizer"],applicableErrors:["api_error","rate_limit","timeout"],priority:5,execute:this.executeCachedResponse.bind(this)},{id:"human-intervention",name:"Human Intervention Required",description:"Flag for human review and manual completion",applicableAgents:["content-writer","content-editor","content-strategist"],applicableErrors:["critical_failure","quality_threshold_not_met"],priority:6,execute:this.executeHumanIntervention.bind(this)}].forEach(a=>{this.fallbackStrategies.set(a.id,a)})}async handleError(a,b,c,d,e=1,f=3){let g={agentId:a,attemptNumber:e,totalAttempts:f,errorType:this.categorizeError(b),errorMessage:b.message,timestamp:new Date,requestContext:d};this.logError(g),console.log(`🚨 Error recovery for ${a} (attempt ${e}/${f}): ${b.message}`);let h=this.generateRecoveryPlans(g);if(0===h.length)return console.log(`❌ No recovery strategies available for ${a}`),{recovered:!1};for(let b of h)try{console.log(`🔄 Trying recovery strategy: ${b.strategy.name}`);let c=await b.strategy.execute(g);if(c)return console.log(`✅ Recovery successful using ${b.strategy.name}`),this.recordSuccess(a,b.strategy.id),{recovered:!0,result:c,strategy:b.strategy.name,qualityImpact:b.qualityImpact}}catch(c){console.warn(`Recovery strategy ${b.strategy.name} failed:`,c),this.recordFailure(a,b.strategy.id)}return console.log(`❌ All recovery strategies failed for ${a}`),{recovered:!1}}categorizeError(a){let b=a.message.toLowerCase();return b.includes("timeout")||b.includes("aborted")?"timeout":b.includes("rate limit")||b.includes("quota")?"rate_limit":b.includes("parse")||b.includes("json")||b.includes("invalid")?"parsing_error":b.includes("401")||b.includes("403")||b.includes("unauthorized")?"auth_error":b.includes("500")||b.includes("502")||b.includes("503")?"api_error":b.includes("network")||b.includes("connection")?"network_error":"unknown_error"}generateRecoveryPlans(a){return Array.from(this.fallbackStrategies.values()).filter(b=>b.applicableAgents.includes(a.agentId)&&(b.applicableErrors.includes(a.errorType)||b.applicableErrors.includes("any"))).map(b=>{let c=this.getSuccessRate(a.agentId,b.id),d=this.estimateRecoveryDuration(b,a),e=this.estimateQualityImpact(b,a);return{strategy:b,estimatedSuccessRate:c,estimatedDuration:d,qualityImpact:e}}).sort((a,b)=>{let c=.7*a.estimatedSuccessRate+(10-a.strategy.priority)*.3;return .7*b.estimatedSuccessRate+(10-b.strategy.priority)*.3-c})}async executeSimplifiedPrompt(a){switch(a.agentId){case"content-writer":return{content:{title:"Generated Content Title",introduction:"This is a simplified introduction generated as a fallback.",mainContent:[{heading:"Main Section",paragraphs:["Simplified content paragraph with key information."],bulletPoints:["Key point 1","Key point 2","Key point 3"]}],conclusion:"Simplified conclusion summarizing the main points.",callToAction:"Take action now to learn more."},metadata:{wordCount:150,readingTime:1,keywordDensity:{primary:2,secondary:1},tone:"professional",readabilityScore:75},fallbackUsed:!0,strategy:"simplified-prompt"};case"market-researcher":return{industry:"General Market",trends:["Digital transformation","Customer experience focus","Data-driven decisions"],opportunities:["Market expansion","Technology adoption"],keyInsights:["Market is evolving rapidly","Customer needs are changing"],fallbackUsed:!0,strategy:"simplified-prompt"};default:return{fallbackResponse:!0,message:"Simplified fallback response generated",strategy:"simplified-prompt"}}}async executeTemplateFallback(a){return{...this.getTemplateForAgent(a.agentId),fallbackUsed:!0,strategy:"template-fallback"}}async executeReducedScope(a){return{...this.generateReducedScopeOutput(a.agentId),fallbackUsed:!0,strategy:"reduced-scope",note:"This is a reduced scope output due to processing constraints"}}async executeAlternativeAgent(a){return{alternativeResponse:!0,agentId:a.agentId,message:"Alternative processing completed",fallbackUsed:!0,strategy:"alternative-agent"}}async executeCachedResponse(a){return{...this.getCachedResponse(a.agentId),fallbackUsed:!0,strategy:"cached-response",note:"Adapted from previous successful execution"}}async executeHumanIntervention(a){return{requiresHumanIntervention:!0,agentId:a.agentId,errorContext:a,fallbackUsed:!0,strategy:"human-intervention",instructions:"This task requires manual completion or review"}}getTemplateForAgent(a){return({"content-writer":{content:{title:"Professional Content Template",introduction:"This template provides a structured approach to content creation.",mainContent:[{heading:"Key Benefits",paragraphs:["Template-based content ensures consistency and quality."],bulletPoints:["Reliable structure","Consistent quality","Fast delivery"]}],conclusion:"Templates provide a solid foundation for content creation.",callToAction:"Contact us to learn more about our services."},metadata:{wordCount:100,readingTime:1,keywordDensity:{primary:1.5,secondary:1},tone:"professional",readabilityScore:80}},"social-media-specialist":{platforms:[{platform:"linkedin",content:"Professional update about our latest insights.",hashtags:["#business","#insights","#professional"],mediaRecommendations:["Professional image or infographic"]}]}})[a]||{templateContent:"Generic template response"}}generateReducedScopeOutput(a){return({"content-writer":{content:{title:"Essential Content",introduction:"Core content essentials.",mainContent:[{heading:"Main Point",paragraphs:["Essential information."]}],conclusion:"Key takeaway.",callToAction:"Learn more."},metadata:{wordCount:50,readingTime:1,tone:"brief"}},"market-researcher":{industry:"Market Analysis",trends:["Current trend"],opportunities:["Key opportunity"],keyInsights:["Main insight"]}})[a]||{reducedContent:"Minimal viable output"}}getCachedResponse(a){return{cachedContent:!0,agentId:a,content:"Previously successful content adapted for current context",timestamp:new Date().toISOString(),confidence:.7}}logError(a){let b=this.errorHistory.get(a.agentId)||[];b.push(a),b.length>50&&b.splice(0,b.length-50),this.errorHistory.set(a.agentId,b)}recordSuccess(a,b){let c=`${a}:${b}`,d=this.successRates.get(c)||{successes:0,attempts:0};d.successes++,d.attempts++,this.successRates.set(c,d)}recordFailure(a,b){let c=`${a}:${b}`,d=this.successRates.get(c)||{successes:0,attempts:0};d.attempts++,this.successRates.set(c,d)}getSuccessRate(a,b){let c=`${a}:${b}`,d=this.successRates.get(c);return d&&0!==d.attempts?d.successes/d.attempts:.5}estimateRecoveryDuration(a,b){return({"simplified-prompt":30,"template-fallback":10,"reduced-scope":20,"alternative-agent":40,"cached-response":5,"human-intervention":300})[a.id]||60}estimateQualityImpact(a,b){return({"simplified-prompt":.85,"template-fallback":.75,"reduced-scope":.65,"alternative-agent":.8,"cached-response":.9,"human-intervention":.95})[a.id]||.7}getErrorAnalytics(a){let b=a?this.errorHistory.get(a)||[]:Array.from(this.errorHistory.values()).flat(),c={},d={};b.forEach(a=>{c[a.errorType]=(c[a.errorType]||0)+1,d[a.errorType]||(d[a.errorType]=new Set),d[a.errorType].add(a.agentId)});let e=Array.from(this.successRates.values()).reduce((a,b)=>a+b.successes,0),f=Array.from(this.successRates.values()).reduce((a,b)=>a+b.attempts,0),g=f>0?e/f:0,h=Object.entries(c).map(([a,b])=>({type:a,count:b,agents:Array.from(d[a]||[])})).sort((a,b)=>b.count-a.count).slice(0,5),i=this.generateRecommendations(h,g);return{totalErrors:b.length,errorsByType:c,recoverySuccessRate:g,mostCommonErrors:h,recommendations:i}}generateRecommendations(a,b){let c=[];return b<.7&&c.push("Consider improving base agent reliability to reduce fallback dependency"),a.forEach(a=>{switch(a.type){case"timeout":c.push("Increase timeout values or optimize prompts for faster responses");break;case"rate_limit":c.push("Implement request queuing or use multiple API keys for load distribution");break;case"parsing_error":c.push("Improve JSON parsing robustness and response validation");break;case"api_error":c.push("Add circuit breakers and better API health monitoring")}}),0===c.length&&c.push("System resilience appears healthy based on current metrics"),c.slice(0,5)}}},74674:(a,b,c)=>{c.a(a,async(a,d)=>{try{c.d(b,{l:()=>g});var e=c(65869),f=a([e]);e=(f.then?(await f)():f)[0];class g extends e.Z{constructor(){super("Evaluator-Optimizer"),this.qualityThreshold=.75,this.maxOptimizationCycles=3}async execute(a,b){return{status:"evaluator-optimizer-ready"}}async evaluateAgentOutput(a,b,c,d){this.logExecution(`Evaluating output from ${a}`);try{let d=await this.calculateQualityMetrics(a,b,c),e=await this.generateOptimizationSuggestions(a,b,d,c),f=d.overallScore<this.qualityThreshold&&this.hasSignificantIssues(e),g=f?await this.generateRetryInstructions(a,b,e,c):void 0;return this.logExecution(`Evaluation completed for ${a}`,{overallScore:d.overallScore,shouldRetry:f,suggestionsCount:e.length}),{agentId:a,output:b,metrics:d,suggestions:e,shouldRetry:f,retryInstructions:g}}catch(c){return console.error(`Evaluation failed for ${a}:`,c),{agentId:a,output:b,metrics:this.getDefaultMetrics(),suggestions:[],shouldRetry:!1}}}async calculateQualityMetrics(a,b,c){let d=`Evaluate the quality of this ${a} output for a ${c.contentType} project about "${c.topic}".

OUTPUT TO EVALUATE:
${JSON.stringify(b,null,2)}

EVALUATION CRITERIA:
1. Content Quality (0-1): Accuracy, depth, relevance, structure
2. SEO Optimization (0-1): Keyword usage, meta elements, search optimization
3. Brand Alignment (0-1): Tone, voice, message consistency
4. Engagement Potential (0-1): Hooks, emotional triggers, call-to-actions
5. Technical Accuracy (0-1): Format compliance, data completeness

Respond with this JSON format:
{
  "contentQuality": 0.85,
  "seoOptimization": 0.78,
  "brandAlignment": 0.92,
  "engagementPotential": 0.80,
  "technicalAccuracy": 0.88,
  "overallScore": 0.85,
  "reasoning": "Brief explanation of scores"
}`;try{let a=await this.callLLM(d,{maxTokens:1e3,temperature:.3}),b=this.extractJSONFromResponse(a),c={contentQuality:Math.max(0,Math.min(1,b.contentQuality||.7)),seoOptimization:Math.max(0,Math.min(1,b.seoOptimization||.7)),brandAlignment:Math.max(0,Math.min(1,b.brandAlignment||.7)),engagementPotential:Math.max(0,Math.min(1,b.engagementPotential||.7)),technicalAccuracy:Math.max(0,Math.min(1,b.technicalAccuracy||.7)),overallScore:0};return c.overallScore=.3*c.contentQuality+.2*c.seoOptimization+.2*c.brandAlignment+.2*c.engagementPotential+.1*c.technicalAccuracy,c}catch(b){return console.warn(`Failed to calculate quality metrics for ${a}, using defaults`),this.getDefaultMetrics()}}async generateOptimizationSuggestions(a,b,c,d){let e=[];c.contentQuality<.7&&e.push({agentId:a,issue:"Low content quality score",suggestion:"Improve content depth, accuracy, and relevance to the topic",priority:"high",estimatedImpact:.25}),c.seoOptimization<.7&&e.push({agentId:a,issue:"Poor SEO optimization",suggestion:"Better keyword integration, meta descriptions, and heading structure",priority:"high",estimatedImpact:.2}),c.brandAlignment<.7&&e.push({agentId:a,issue:"Brand alignment issues",suggestion:"Ensure tone, voice, and messaging align with brand guidelines",priority:"medium",estimatedImpact:.15}),c.engagementPotential<.7&&e.push({agentId:a,issue:"Low engagement potential",suggestion:"Add stronger hooks, emotional triggers, and clear call-to-actions",priority:"medium",estimatedImpact:.18}),c.technicalAccuracy<.7&&e.push({agentId:a,issue:"Technical formatting issues",suggestion:"Fix JSON structure, ensure all required fields are present",priority:"high",estimatedImpact:.15});let f=await this.getAgentSpecificSuggestions(a,b,d);return e.push(...f),e.sort((a,b)=>{let c={high:3,medium:2,low:1};return c[b.priority]-c[a.priority]||b.estimatedImpact-a.estimatedImpact})}async getAgentSpecificSuggestions(a,b,c){let d=[];switch(a){case"content-writer":(!b.content?.mainContent||b.content.mainContent.length<3)&&d.push({agentId:a,issue:"Insufficient content sections",suggestion:"Add at least 3-5 well-structured main content sections",priority:"high",estimatedImpact:.3}),(!b.metadata?.wordCount||b.metadata.wordCount<800)&&d.push({agentId:a,issue:"Content too short",suggestion:"Expand content to at least 800-1200 words for better SEO",priority:"medium",estimatedImpact:.2});break;case"market-researcher":(!b.trends||b.trends.length<3)&&d.push({agentId:a,issue:"Insufficient market trends",suggestion:"Research and include at least 3-5 relevant market trends",priority:"high",estimatedImpact:.25});break;case"ai-seo-optimizer":(!b.keywordStrategy?.primaryKeywords||b.keywordStrategy.primaryKeywords.length<3)&&d.push({agentId:a,issue:"Insufficient keyword research",suggestion:"Identify and optimize for at least 3-5 primary keywords",priority:"high",estimatedImpact:.3});break;case"audience-analyzer":(!b.primaryPersona?.painPoints||b.primaryPersona.painPoints.length<3)&&d.push({agentId:a,issue:"Shallow persona analysis",suggestion:"Develop deeper insights into audience pain points and motivations",priority:"medium",estimatedImpact:.2})}return d}async generateRetryInstructions(a,b,c,d){let e=c.filter(a=>"high"===a.priority);if(0===e.length)return"Please improve the overall quality based on the evaluation feedback.";let f=`Generate specific retry instructions for ${a} to address these issues:

HIGH PRIORITY ISSUES:
${e.map(a=>`- ${a.issue}: ${a.suggestion}`).join("\n")}

ORIGINAL REQUEST:
Topic: ${d.topic}
Content Type: ${d.contentType}
Audience: ${d.audience}

CURRENT OUTPUT STRUCTURE:
${JSON.stringify(Object.keys(b),null,2)}

Generate clear, actionable instructions for the agent to fix these issues in a retry attempt. Be specific about what needs to be changed or added.`;try{return(await this.callLLM(f,{maxTokens:800,temperature:.5})).trim()}catch(a){return console.warn("Failed to generate retry instructions, using fallback"),`Please address these key issues: ${e.map(a=>a.suggestion).join("; ")}`}}async optimizeWorkflow(a,b,c=this.maxOptimizationCycles){let d=new Map(a),e=0;for(this.logExecution("Starting workflow optimization",{agentsCount:a.size,maxCycles:c});e<c;){e++,console.log(`🔍 Optimization cycle ${e}/${c}`);let a=new Map,f=!1;for(let[c,e]of d){let g=await this.evaluateAgentOutput(c,e,b,{previousOutputs:Object.fromEntries(d)});a.set(c,g),g.shouldRetry&&(f=!0)}if(!f){console.log(`✅ No optimization needed, stopping at cycle ${e}`);break}let g=[];for(let[c,e]of a)e.shouldRetry&&e.retryInstructions&&g.push(this.retryAgentWithOptimization(c,e,b,d).then(a=>{a&&d.set(c,a)}));await Promise.allSettled(g)}return this.logExecution("Workflow optimization completed",{cyclesUsed:e,finalResultsCount:d.size}),d}async retryAgentWithOptimization(a,b,c,d){try{console.log(`🔄 Optimizing ${a} with instructions:`,b.retryInstructions?.substring(0,100));let e=this.createOptimizedPrompt(a,b,c,d),f=await this.callLLM(e,{maxTokens:4e3,temperature:.7}),g=this.extractJSONFromResponse(f);return console.log(`✅ ${a} optimization completed`),g}catch(b){return console.error(`❌ Failed to optimize ${a}:`,b),null}}createOptimizedPrompt(a,b,c,d){let e=Object.fromEntries(d);return`You are a professional ${a.replace("-"," ")} tasked with creating optimized content.

OPTIMIZATION INSTRUCTIONS:
${b.retryInstructions}

QUALITY IMPROVEMENTS NEEDED:
${b.suggestions.map(a=>`- ${a.suggestion}`).join("\n")}

ORIGINAL REQUEST:
- Topic: ${c.topic}
- Content Type: ${c.contentType}
- Audience: ${c.audience}
- Goals: ${c.goals}
- Tone: ${c.tone||"Professional and engaging"}

CONTEXT FROM OTHER AGENTS:
${JSON.stringify(e,null,2)}

PREVIOUS OUTPUT (FOR REFERENCE):
${JSON.stringify(b.output,null,2)}

Create an improved version that addresses all the optimization instructions and quality issues. 
Ensure your output follows the exact same JSON structure as the previous version but with enhanced quality and completeness.`}hasSignificantIssues(a){let b=a.filter(a=>"high"===a.priority).length,c=a.reduce((a,b)=>a+b.estimatedImpact,0);return b>0||c>.3}getDefaultMetrics(){return{contentQuality:.7,seoOptimization:.7,brandAlignment:.7,engagementPotential:.7,technicalAccuracy:.7,overallScore:.7}}async generateQualityReport(a){let b=Array.from(a.values()).map(a=>a.metrics.overallScore),c=b.reduce((a,b)=>a+b,0)/b.length,d=Array.from(a.entries()).map(([a,b])=>({agentId:a,score:b.metrics.overallScore,status:b.shouldRetry?"needs-improvement":"acceptable"})),e=Array.from(a.values()).flatMap(a=>a.suggestions),f=e.filter(a=>"high"===a.priority).length,g=this.generateTopRecommendations(e);return{overallScore:c,agentScores:d,totalSuggestions:e.length,criticalIssues:f,recommendations:g}}generateTopRecommendations(a){return a.filter(a=>"high"===a.priority).sort((a,b)=>b.estimatedImpact-a.estimatedImpact).slice(0,5).map(a=>a.suggestion)}async calculateQualityScores(a,b,c){try{let d=await this.evaluateAgentOutput("final-content",a,b,{previousOutputs:Object.fromEntries(c)});return{overall:d.metrics.overallScore,content:d.metrics.contentQuality,seo:d.metrics.seoOptimization,engagement:d.metrics.engagementPotential,brand:d.metrics.brandAlignment}}catch(a){return console.warn("Quality score calculation failed, using defaults:",a),{overall:.75,content:.75,seo:.75,engagement:.75,brand:.75}}}}d()}catch(a){d(a)}})},86439:a=>{a.exports=require("next/dist/shared/lib/no-fallback-error.external")}};var b=require("../../../../webpack-runtime.js");b.C(a);var c=b.X(0,[985,55,286],()=>b(b.s=50489));module.exports=c})();